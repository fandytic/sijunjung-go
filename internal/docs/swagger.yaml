basePath: /
definitions:
  http.APIErrorResponse:
    description: Standard API error response
    properties:
      code:
        example: 400
        type: integer
      message:
        example: invalid request
        type: string
      success:
        example: false
        type: boolean
    type: object
  http.APIResponse:
    description: Standard API response
    properties:
      code:
        example: 200
        type: integer
      data:
        type: object
      message:
        example: operation successful
        type: string
      success:
        example: true
        type: boolean
    type: object
  http.FacebookAuthData:
    description: Facebook auth data
    properties:
      is_new_user:
        example: true
        type: boolean
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
      token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    type: object
  http.GoogleAuthData:
    description: Google auth data
    properties:
      is_new_user:
        example: true
        type: boolean
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
      token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    type: object
  http.SijunjungData:
    description: Sijunjung service data
    properties:
      status:
        example: running
        type: string
    type: object
  http.TokenData:
    description: Token data
    properties:
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
      token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    type: object
  http.UserData:
    description: User data
    properties:
      role:
        example: user
        type: string
      user_id:
        example: 507f1f77bcf86cd799439011
        type: string
    type: object
  model.CreateAccountRequest:
    description: Request body for creating a new account by Super Admin
    properties:
      email:
        example: admin@sijunjung.go
        type: string
      full_name:
        example: Admin User
        type: string
      password:
        example: password123
        type: string
      role:
        allOf:
        - $ref: '#/definitions/model.UserRole'
        example: admin
    type: object
  model.FacebookAuthRequest:
    description: Request body for Facebook authentication
    properties:
      access_token:
        example: EAABsbCS1...
        type: string
    type: object
  model.GoogleMobileAuthRequest:
    description: Request body for Google authentication from mobile apps (Flutter)
    properties:
      id_token:
        example: eyJhbGciOiJSUzI1NiIsImtpZCI6IjEyMzQ...
        type: string
    type: object
  model.LoginRequest:
    description: Request body for user login
    properties:
      email:
        example: sijunjunggo@gmail.com
        type: string
      password:
        example: password123
        type: string
    type: object
  model.LogoutRequest:
    description: Request body for logout (optional refresh token to revoke)
    properties:
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    type: object
  model.RefreshTokenRequest:
    description: Request body for refreshing access token
    properties:
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    type: object
  model.RegisterRequest:
    description: Request body for user registration
    properties:
      email:
        example: sijunjunggo@gmail.com
        type: string
      full_name:
        example: Sijunjung Go
        type: string
      password:
        example: password123
        type: string
    type: object
  model.ResendOTPRequest:
    description: Request body for resending OTP
    properties:
      email:
        example: sijunjunggo@gmail.com
        type: string
    type: object
  model.ResetPasswordRequest:
    description: Request body for password reset
    properties:
      email:
        example: sijunjunggo@gmail.com
        type: string
    type: object
  model.SendWhatsAppOTPRequest:
    description: Request body for sending OTP via WhatsApp
    properties:
      phone:
        example: "628123456789"
        type: string
    type: object
  model.UpdateAccountRequest:
    description: Request body for updating an account
    properties:
      email:
        example: newemail@sijunjung.go
        type: string
      full_name:
        example: Updated Name
        type: string
    type: object
  model.UserRole:
    enum:
    - super_admin
    - admin
    - merchant
    - mitra
    - user
    type: string
    x-enum-varnames:
    - RoleSuperAdmin
    - RoleAdmin
    - RoleMerchant
    - RoleMitra
    - RoleUser
  model.VerifyOTPRequest:
    description: Request body for OTP verification
    properties:
      code:
        example: "5318"
        type: string
      email:
        example: sijunjunggo@gmail.com
        type: string
    type: object
  model.VerifyWhatsAppOTPRequest:
    description: Request body for verifying WhatsApp OTP
    properties:
      code:
        example: "5318"
        type: string
      phone:
        example: "628123456789"
        type: string
    type: object
host: localhost:8080
info:
  contact: {}
  description: API for Sijunjung Go application with multi-role authentication support
  title: Sijunjung Go API
  version: "2.0"
paths:
  /api/cms/accounts:
    get:
      description: Get all accounts filtered by role (Super Admin only)
      parameters:
      - description: Role filter (admin, merchant, or mitra)
        in: query
        name: role
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Accounts list
          schema:
            $ref: '#/definitions/http.APIResponse'
        "400":
          description: Invalid role parameter
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "403":
          description: Forbidden - Super Admin only
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: List accounts by role
      tags:
      - cms
    post:
      consumes:
      - application/json
      description: Create a new Admin, Merchant, or Mitra account (Super Admin only)
      parameters:
      - description: Create account request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.CreateAccountRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Account created successfully
          schema:
            $ref: '#/definitions/http.APIResponse'
        "400":
          description: Invalid request or email already exists
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "403":
          description: Forbidden - Super Admin only
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Create account
      tags:
      - cms
  /api/cms/accounts/{id}:
    delete:
      description: Permanently delete an account (Super Admin only)
      parameters:
      - description: Account ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Account deleted
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  type: object
              type: object
        "400":
          description: Failed to delete
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "403":
          description: Forbidden - Super Admin only
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete account
      tags:
      - cms
    get:
      description: Get a single account by ID (Super Admin only)
      parameters:
      - description: Account ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Account detail
          schema:
            $ref: '#/definitions/http.APIResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "403":
          description: Forbidden - Super Admin only
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "404":
          description: Account not found
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Get account detail
      tags:
      - cms
    put:
      consumes:
      - application/json
      description: Update an account's full name and/or email (Super Admin only)
      parameters:
      - description: Account ID
        in: path
        name: id
        required: true
        type: string
      - description: Update account request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.UpdateAccountRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Account updated
          schema:
            $ref: '#/definitions/http.APIResponse'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "403":
          description: Forbidden - Super Admin only
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Update account
      tags:
      - cms
  /api/cms/accounts/{id}/reset-password:
    post:
      description: Reset an account's password and return the new password (Super
        Admin only)
      parameters:
      - description: Account ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Password reset successfully
          schema:
            $ref: '#/definitions/http.APIResponse'
        "400":
          description: Account not found
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "403":
          description: Forbidden - Super Admin only
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Reset account password
      tags:
      - cms
  /api/cms/login:
    post:
      consumes:
      - application/json
      description: Authenticate Super Admin or Admin with email and password
      parameters:
      - description: Login request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Login successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.TokenData'
              type: object
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Invalid credentials or unauthorized role
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Login CMS
      tags:
      - cms
  /api/login:
    post:
      consumes:
      - application/json
      description: Authenticate user with email and password to get bearer token (legacy
        endpoint, use /api/user/login instead)
      parameters:
      - description: Login request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Login successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.TokenData'
              type: object
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Invalid credentials
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Login user (legacy)
      tags:
      - legacy
  /api/merchant/dashboard:
    get:
      description: Get merchant dashboard data
      produces:
      - application/json
      responses:
        "200":
          description: Dashboard data
          schema:
            $ref: '#/definitions/http.APIResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "403":
          description: Forbidden - Merchant only
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Merchant dashboard
      tags:
      - merchant
  /api/merchant/login:
    post:
      consumes:
      - application/json
      description: Authenticate merchant with email and password
      parameters:
      - description: Login request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Login successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.TokenData'
              type: object
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Invalid credentials or unauthorized role
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Login merchant
      tags:
      - merchant
  /api/mitra/dashboard:
    get:
      description: Get mitra dashboard data
      produces:
      - application/json
      responses:
        "200":
          description: Dashboard data
          schema:
            $ref: '#/definitions/http.APIResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "403":
          description: Forbidden - Mitra only
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Mitra dashboard
      tags:
      - mitra
  /api/mitra/login:
    post:
      consumes:
      - application/json
      description: Authenticate mitra with email and password
      parameters:
      - description: Login request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Login successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.TokenData'
              type: object
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Invalid credentials or unauthorized role
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Login mitra
      tags:
      - mitra
  /api/user/account:
    delete:
      description: Permanently delete the current user account and all associated
        data
      produces:
      - application/json
      responses:
        "200":
          description: Account deleted successfully
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  type: object
              type: object
        "400":
          description: Failed to delete account
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete user account
      tags:
      - user
  /api/user/auth/facebook:
    post:
      consumes:
      - application/json
      description: Authenticate or register user with Facebook access token
      parameters:
      - description: Facebook auth request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.FacebookAuthRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Authentication successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.FacebookAuthData'
              type: object
        "400":
          description: Invalid Facebook token
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Authenticate with Facebook
      tags:
      - user
  /api/user/auth/google:
    get:
      description: Redirects user to Google OAuth consent page for login/registration
      parameters:
      - description: State parameter for CSRF protection
        in: query
        name: state
        type: string
      responses:
        "302":
          description: Redirect to Google OAuth
      summary: Redirect to Google OAuth
      tags:
      - user
  /api/user/auth/google-mobile:
    post:
      consumes:
      - application/json
      description: Authenticate or register user with Google ID token from mobile
        client (Flutter)
      parameters:
      - description: Google mobile auth request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.GoogleMobileAuthRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Authentication successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.GoogleAuthData'
              type: object
        "400":
          description: Invalid Google token
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Authenticate with Google (Mobile)
      tags:
      - user
  /api/user/auth/google/callback:
    get:
      description: Handle callback from Google OAuth and return JWT token
      parameters:
      - description: Authorization code from Google
        in: query
        name: code
        required: true
        type: string
      - description: State parameter for CSRF protection
        in: query
        name: state
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Authentication successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.GoogleAuthData'
              type: object
        "400":
          description: Invalid authorization code
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Google OAuth callback
      tags:
      - user
  /api/user/login:
    post:
      consumes:
      - application/json
      description: Authenticate user with email and password (validates role=user)
      parameters:
      - description: Login request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Login successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.TokenData'
              type: object
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Invalid credentials or unauthorized role
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Login user
      tags:
      - user
  /api/user/logout:
    post:
      consumes:
      - application/json
      description: Revoke the current access token and optionally the refresh token
      parameters:
      - description: Logout request with optional refresh token
        in: body
        name: request
        schema:
          $ref: '#/definitions/model.LogoutRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Logout successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  type: object
              type: object
        "400":
          description: Invalid or missing token
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Logout user
      tags:
      - user
  /api/user/me:
    get:
      description: Get the current authenticated user information including role
      produces:
      - application/json
      responses:
        "200":
          description: Current user info
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.UserData'
              type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Get current user
      tags:
      - user
  /api/user/refresh-token:
    post:
      consumes:
      - application/json
      description: Use a refresh token to get a new access token and refresh token
        pair
      parameters:
      - description: Refresh token request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.RefreshTokenRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Token refreshed successfully
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.TokenData'
              type: object
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "401":
          description: Invalid or expired refresh token
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Refresh access token
      tags:
      - user
  /api/user/register:
    post:
      consumes:
      - application/json
      description: Register a new user with full name, email, and password. Sends
        OTP to email for verification.
      parameters:
      - description: Registration request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.RegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: User created and OTP sent
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  type: object
              type: object
        "400":
          description: Invalid request or email already exists
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Register a new user
      tags:
      - user
  /api/user/resend-otp:
    post:
      consumes:
      - application/json
      description: Resend the OTP code to email (1 minute cooldown)
      parameters:
      - description: Resend OTP request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.ResendOTPRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OTP resent successfully
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  type: object
              type: object
        "400":
          description: User not found or cooldown active
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "429":
          description: Please wait before requesting new code
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Resend OTP code
      tags:
      - user
  /api/user/reset-password:
    post:
      consumes:
      - application/json
      description: Reset password by sending a new random password to user's email
      parameters:
      - description: Reset password request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.ResetPasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: New password sent to email
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  type: object
              type: object
        "400":
          description: User not found or invalid request
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Reset password
      tags:
      - user
  /api/user/sijunjung:
    get:
      description: Check if Sijunjung service is running
      produces:
      - application/json
      responses:
        "200":
          description: Service is running
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.SijunjungData'
              type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      security:
      - BearerAuth: []
      summary: Check Sijunjung service
      tags:
      - sijunjung
  /api/user/verify-otp:
    post:
      consumes:
      - application/json
      description: Verify the OTP code sent to email and get bearer token
      parameters:
      - description: Verify OTP request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.VerifyOTPRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Verification successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/http.TokenData'
              type: object
        "400":
          description: Invalid or expired code
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Verify OTP code
      tags:
      - user
  /api/user/whatsapp/send-otp:
    post:
      consumes:
      - application/json
      description: Send an OTP code to the specified WhatsApp number (1 minute cooldown)
      parameters:
      - description: Send WhatsApp OTP request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.SendWhatsAppOTPRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OTP sent successfully
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  type: object
              type: object
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
        "429":
          description: Please wait before requesting new code
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Send OTP via WhatsApp
      tags:
      - user
  /api/user/whatsapp/verify-otp:
    post:
      consumes:
      - application/json
      description: Verify the OTP code sent to WhatsApp
      parameters:
      - description: Verify WhatsApp OTP request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/model.VerifyWhatsAppOTPRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Verification successful
          schema:
            allOf:
            - $ref: '#/definitions/http.APIResponse'
            - properties:
                data:
                  type: object
              type: object
        "400":
          description: Invalid or expired code
          schema:
            $ref: '#/definitions/http.APIErrorResponse'
      summary: Verify WhatsApp OTP code
      tags:
      - user
securityDefinitions:
  BearerAuth:
    description: 'Enter your bearer token in the format: Bearer {token}'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
